{{!-- views/delivery/order-detail.hbs --}}
<main class="container py-4">
  <div class="text-center mb-5">
    {{#if order.merchant.merchantLogo}}
      <img src="/images/{{order.merchant.merchantLogo}}"
           alt="{{order.merchant.merchantName}}"
           class="mb-3 rounded"
           style="width:80px; height:80px; object-fit:cover;">
    {{/if}}
    <h2 class="h5 mb-1">{{order.merchant.merchantName}}</h2>

    <span class="badge
      {{#if (eq order.status 'EN PROCESO')}}bg-warning text-dark
      {{else if (eq order.status 'COMPLETADO')}}bg-success
      {{else}}bg-secondary{{/if}}">
      {{order.status}}
    </span>

    <p class="text-muted small mt-1">
      {{order.formattedDate}} · {{order.formattedTime}}
    </p>
  </div>

  {{#if (eq order.status 'EN PROCESO')}}
    <form action="/delivery/order/{{order.id}}/complete" method="POST" class="mb-5">
      <input type="hidden" name="_csrf" value="{{csrfToken}}">
      <button class="btn btn-danger w-100">Completar el pedido</button>
    </form>
  {{/if}}

  <section class="mb-4">
    <h4 class="h6 mb-3">Productos</h4>
    <ul class="list-group">
      {{#each order.order_products}}
        <li class="list-group-item d-flex align-items-center justify-content-between">
          <div class="d-flex align-items-center">
            {{#if this.product.image}}
              <img src="/images/{{this.product.image}}"
                   alt="{{this.product.name}}"
                   class="rounded me-3"
                   style="width:48px; height:48px; object-fit:cover;">
            {{/if}}
            <span>{{this.product.name}}</span>
          </div>
          <span class="fw-bold">RD$ {{this.price}}</span>
        </li>
      {{/each}}
    </ul>
  </section>

  {{!-- <section class="mb-4">
    <h4 class="h6 mb-1">Dirección de entrega</h4>
    <p class="fw-bold">{{order.address.name}}</p>
    <p>{{order.address.description}}</p>
  </section> --}}

 {{#if (eq order.status 'EN PROCESO')}}
    <section class="mb-4">
      <h4 class="h6 mb-1">Dirección de entrega</h4>
      <p class="fw-bold">{{order.address.name}}</p>
      <p>{{order.address.description}}</p>
    </section>
  {{/if}}
  
  <section class="mb-4 d-flex justify-content-between">
    <h4>Total</h4>
    <h4 class="text-success">RD$ {{order.total}}</h4>
  </section>

  <a href="/delivery/home" class="btn btn-outline-secondary">← Volver al tablero</a>
</main>
